# ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆã‚¬ã‚¤ãƒ‰ - API ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ

## ğŸš€ åˆå›ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆã‚³ãƒ¼ãƒ‰ã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã—ãŸå¾Œï¼‰

### å¿…è¦ãªç’°å¢ƒ

- **Java JDK 11ä»¥ä¸Š** ï¼ˆæ—¢ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ï¼‰

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

#### 1. ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³

```powershell
git clone git@github.com:thangvaltec/testserver.git
cd testserver
```

#### 2. ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª

ãƒ†ã‚¹ãƒˆç”¨ã®ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`tan.jpg`ã¾ãŸã¯`park.jpg`ï¼‰ãŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã«ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

#### 3. ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ

```powershell
.\run-java.bat
```

ã“ã‚Œã ã‘ã§ã™ï¼

---

## ğŸ“ å®Ÿè¡Œçµæœ

ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯1å›ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã—ã€ä»¥ä¸‹ã‚’è¡¨ç¤ºã—ã¾ã™ï¼š

```
Request
Sending data: timestamp=1767948039631, deviceId=2222222, policeId=null
Response
status_code: 200
response result: {"status":2,"deviceId":"2222222","policeId":"null","similarity":"96.3","name":"PHANã€€VAN THANG","real_id":"24024","data":"","message":"èªè¨¼æˆåŠŸ\nå‹¤æ€ é€£æºï¼šç„¡åŠ¹\n"}
```

### ğŸ“Š çµæœã®èª¬æ˜

- **status_code: 200** â†’ âœ… ãƒªã‚¯ã‚¨ã‚¹ãƒˆæˆåŠŸ
- **status: 2** â†’ èªè¨¼æˆåŠŸ
- **similarity: 96.3** â†’ é¡”ã®é¡ä¼¼åº¦96.3%
- **name: "PHANã€€VAN THANG"** â†’ èªè­˜ã•ã‚ŒãŸäººç‰©ã®åå‰
- **real_id: "24024"** â†’ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ID
- **message: "èªè¨¼æˆåŠŸ\nå‹¤æ€ é€£æºï¼šç„¡åŠ¹\n"** â†’ ã€Œèªè¨¼æˆåŠŸã€å‹¤æ€ é€£æºï¼šç„¡åŠ¹ã€

---

## ğŸ¯ ã‚³ãƒ¼ãƒ‰ã®ç‰¹å¾´

`test.py`ã¨åŒã˜ã‚·ãƒ³ãƒ—ãƒ«ãªè¨­è¨ˆï¼š
- `policeId = "null"`ã®1ã¤ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã®ã¿
- èª­ã¿ã‚„ã™ãã€ç†è§£ã—ã‚„ã™ã„
- Androidã‚¢ãƒ—ãƒªã¸ã®ç§»æ¤ãŒç°¡å˜

---

## ğŸ“‚ é‡è¦ãªãƒ•ã‚¡ã‚¤ãƒ«

- **TestApiJava.java** - Javaãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®APIãƒ†ã‚¹ãƒˆï¼ˆæ¨å¥¨ï¼‰
- **run-java.bat** - å®Ÿè¡Œç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
- **README.md** - è©³ç´°ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- **tan.jpg** - ãƒ†ã‚¹ãƒˆç”¨ç”»åƒ

---

## ğŸ’¡ Androidã‚¢ãƒ—ãƒªã§ã®ä½¿ç”¨

`TestApiJava.java`ã®ã‚³ãƒ¼ãƒ‰ã¯ã€Androidãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ç›´æ¥ã‚³ãƒ”ãƒ¼ã§ãã¾ã™ï¼š

1. ãƒ­ã‚¸ãƒƒã‚¯å…¨ä½“ã‚’ã‚³ãƒ”ãƒ¼
2. `build.gradle`ã«ä¾å­˜é–¢ä¿‚ã‚’è¿½åŠ ï¼ˆOkHttpã‚’ä½¿ç”¨ã™ã‚‹å ´åˆï¼‰ï¼š
   ```gradle
   implementation 'com.squareup.okhttp3:okhttp:4.12.0'
   ```
3. ã¾ãŸã¯Javaã‚³ãƒ¼ãƒ‰ã®ã‚ˆã†ã«HttpURLConnectionã‚’ä½¿ç”¨ï¼ˆä¾å­˜é–¢ä¿‚ã®è¿½åŠ ä¸è¦ï¼‰
4. ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¹ãƒ¬ãƒƒãƒ‰ã§å®Ÿè¡Œï¼š
   ```java
   new Thread(() -> {
       // main()ã®ã‚³ãƒ¼ãƒ‰ã‚’ã“ã“ã«ã‚³ãƒ”ãƒ¼
   }).start();
   ```

---

## ğŸ”§ ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¤‰æ›´

`TestApiJava.java`ã®**29è¡Œç›®**ã‚’ç·¨é›†ï¼š

#### æ–¹æ³•1ï¼šåŒã˜ãƒ•ã‚©ãƒ«ãƒ€å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆç¾åœ¨ã®è¨­å®šï¼‰
```java
String imagePath = "tan.jpg";  // ãƒ•ã‚©ãƒ«ãƒ€å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«
```

#### æ–¹æ³•2ï¼šçµ¶å¯¾ãƒ‘ã‚¹ï¼ˆæ¨å¥¨ï¼‰
```java
String imagePath = "C:/Users/thangpv/Pictures/my_photo.jpg";  // ãƒ•ãƒ«ãƒ‘ã‚¹
```

#### æ–¹æ³•3ï¼šç›¸å¯¾ãƒ‘ã‚¹
```java
String imagePath = "../images/photo.jpg";  // è¦ªãƒ•ã‚©ãƒ«ãƒ€/images/photo.jpg
String imagePath = "./photos/test.jpg";    // ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€photos/test.jpg
```

#### å…·ä½“ä¾‹ï¼š

```java
// ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã®ç”»åƒ
String imagePath = "C:/Users/thangpv/Desktop/my_face.jpg";

// ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ«ãƒ€ã®ç”»åƒ
String imagePath = "C:/Users/thangpv/Downloads/test_image.jpg";

// OneDriveã®ç”»åƒ
String imagePath = "C:/Users/thangpv/OneDrive - æ ªå¼ä¼šç¤¾ã‚ªãƒ•ã‚£ã‚¹24/Pictures/photo.jpg";
```

**æ³¨æ„ï¼š** 
- Javaã§ã¯`/`ï¼ˆã‚¹ãƒ©ãƒƒã‚·ãƒ¥ï¼‰ã‚’ä½¿ç”¨ã™ã‚‹ã‹ã€`\\`ï¼ˆãƒ€ãƒ–ãƒ«ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ï¼‰ã‚’ä½¿ç”¨
- ä¾‹ï¼š`"C:\\Users\\thangpv\\Desktop\\photo.jpg"`

### URLã¾ãŸã¯Device IDã‚’å¤‰æ›´

`TestApiJava.java`ã®**15-16è¡Œç›®**ã‚’ç·¨é›†ï¼š
```java
private static final String API_URL = "https://mot-recog.facet-cloud.com/recv";
private static final String DEVICE_ID = "2222222";
```

### policeIdã‚’å¤‰æ›´

`TestApiJava.java`ã®**38è¡Œç›®**ã‚’ç·¨é›†ï¼š
```java
String policeId = "null";  // å¿…è¦ã«å¿œã˜ã¦ä»–ã®å€¤ã«å¤‰æ›´
```

---

## â“ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚¨ãƒ©ãƒ¼ã€ŒJava not foundã€

- Java JDK 11ä»¥ä¸Šã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- ç¢ºèªï¼š`java -version`

### ã‚¨ãƒ©ãƒ¼ã€ŒImage file not foundã€

- `tan.jpg`ã¾ãŸã¯`park.jpg`ãŒ`test/`ãƒ•ã‚©ãƒ«ãƒ€ã«ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
- ã¾ãŸã¯ã‚³ãƒ¼ãƒ‰å†…ã®ãƒ‘ã‚¹ã‚’ä¿®æ­£

### ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼

- ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèª
- ã‚µãƒ¼ãƒãƒ¼ã®URLãŒæ­£ã—ã„ã‹ç¢ºèª

### æ—¥æœ¬èªæ–‡å­—ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œãªã„ï¼ˆæ–‡å­—åŒ–ã‘ï¼‰

`è­›ï½´èœ©ç”»äº`ã®ã‚ˆã†ãªè¡¨ç¤ºã§ã¯ãªã`æœ´å“‰æ˜±`ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã¹ãå ´åˆï¼š

**æ–¹æ³•1ï¼šãƒãƒƒãƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ï¼ˆè‡ªå‹•ä¿®æ­£ï¼‰**
```powershell
.\run-java.bat
```
ãƒãƒƒãƒãƒ•ã‚¡ã‚¤ãƒ«ãŒè‡ªå‹•çš„ã«UTF-8ã‚’è¨­å®šã—ã¾ã™ã€‚

**æ–¹æ³•2ï¼šæ‰‹å‹•ã§UTF-8ã‚’è¨­å®š**
```powershell
chcp 65001
javac -encoding UTF-8 TestApiJava.java
java TestApiJava
```

**æ–¹æ³•3ï¼šAndroidã‚¢ãƒ—ãƒªã®å ´åˆ**
å¿ƒé…ä¸è¦ - Androidã¯UTF-8ã‚’è‡ªå‹•çš„ã«æ­£ã—ãå‡¦ç†ã—ã¾ã™ï¼

---

## ğŸ“š ãã®ä»–ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¿…è¦ãªç’°å¢ƒ | å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ |
|---------|----------|------------|
| **Java** (æ¨å¥¨) | Java JDKã®ã¿ | `.\run-java.bat` |
| **Kotlin Simple** | Java + Kotlin compiler | `.\run-simple.bat` |
| **Kotlin Script** | Kotlin compiler | `kotlin SimpleTestApi.kts` |
| **Gradle** | Java + Gradle | `.\gradlew.bat run` |
| **Python** (å‚è€ƒ) | Python + requests | `python test.py` |

---

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ãƒ†ã‚¹ãƒˆç›®çš„ã§ã®ä½¿ç”¨ã¯è‡ªç”±ã§ã™ã€‚
